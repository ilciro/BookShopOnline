<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="it"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CsvOggettoDao.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">BookShopOnline Maven Webapp</a> &gt; <a href="index.source.html" class="el_package">laptop.database.csv</a> &gt; <span class="el_source">CsvOggettoDao.java</span></div><h1>CsvOggettoDao.java</h1><pre class="source lang-java linenums">package laptop.database.csv;

import com.opencsv.CSVReader;
import com.opencsv.CSVWriter;
import com.opencsv.exceptions.CsvValidationException;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import laptop.controller.ControllerSystemState;
import laptop.exception.IdException;
import laptop.model.raccolta.Giornale;
import laptop.model.raccolta.Libro;
import laptop.model.raccolta.Raccolta;
import laptop.model.raccolta.Rivista;
import laptop.utilities.ConnToDb;
import org.apache.commons.lang.SystemUtils;

import java.io.*;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.attribute.FileAttribute;
import java.nio.file.attribute.PosixFilePermission;
import java.nio.file.attribute.PosixFilePermissions;

import java.time.LocalDate;

import java.util.Set;
import java.util.logging.Level;

import static java.nio.file.StandardCopyOption.REPLACE_EXISTING;

<span class="fc" id="L31">public class CsvOggettoDao implements DaoInterface{</span>

    private static final String LOCATIONG = &quot;report/reportGiornale.csv&quot;;
    private static final int GETINDEXTITOLOG = 0;
    private static final int GETINDEXTIPOLOGIAG = 1;
    private static final int GETINDEXLINGUAG = 2;
    private static final int GETINDEXEDITOREG = 3;
    private static final int GETINDEXDATAG = 4;
    private static final int GETINDEXCOPIERG = 5;
    private static final int GETINDEXDISPG = 6;
    private static final int GETINDEXPREZZOG = 7;
    private static final int GETINDEXIDG = 8;

    private static final String LOCATIONL = &quot;report/reportLibro.csv&quot;;
    private static final int GETINDEXTITOLOL = 0;
    private static final int GETINDEXNRPL = 1;
    private static final int GETINDEXISBNL = 2;
    private static final int GETINDEXEDITOREL = 3;
    private static final int GETINDEXAUTOREL = 4;
    private static final int GETINDEXLINGUAL = 5;
    private static final int GETINDEXCATEGORIAL = 6;
    private static final int GETINDEXDATAL = 7;
    private static final int GETINDEXRECENSIONEL = 8;
    private static final int GETINDEXCOPIEL = 9;
    private static final int GETINDEXDESCL = 10;
    private static final int GETINDEXDISPL = 11;
    private static final int GETINDEXPREZZOL = 12;
    private static final int GETINDEXIDL = 13;


    private static final String LOCATIONR = &quot;report/reportRivista.csv&quot;;
    private static final int GETINDEXTITOLOR = 0;
    private static final int GETINDEXTIPOLOGIAR = 1;
    private static final int GETINDEXAUTORER = 2;
    private static final int GETINDEXLINGUAR = 3;
    private static final int GETINDEXEDITORER = 4;
    private static final int GETINDEXDESCRIZIONER = 5;
    private static final int GETINDEXDATAR = 6;
    private static final int GETINDEXDISPR = 7;
    private static final int GETINDEXPREZZOR = 8;
    private static final int GETINDEXCOPIER=9;
    private static final int GETINDEXIDR=10;

    private static final String LIBRO=&quot;libro&quot;;
    private static final String GIORNALE=&quot;giornale&quot;;
    private static final String RIVISTA=&quot;rivista&quot;;

    private static final String USERNOTFOUND=&quot; user not found -&gt; id null&quot;;



<span class="fc" id="L82">    private static final ControllerSystemState vis= ControllerSystemState.getInstance();</span>

    private static void cleanUp(Path path) throws IOException {
<span class="fc" id="L85">        Files.delete(path);</span>
<span class="fc" id="L86">    }</span>


    @Override
    public ObservableList&lt;Raccolta&gt; retrieveAllData(File fd) throws CsvValidationException, IOException, IdException {
<span class="fc" id="L91">        return retrieveData(fd);</span>
    }

    @Override
    public void inserisciLibro(Libro l) throws IOException, CsvValidationException {
<span class="nc" id="L96">        inserimentoLibro(l);</span>
<span class="nc" id="L97">    }</span>
    @Override
    public void inserisciGiornale(Giornale g) throws IOException, CsvValidationException {
<span class="nc" id="L100">        inserimentoGiornale(g);</span>
<span class="nc" id="L101">    }</span>
    @Override
    public void inserisciRivista(Rivista r) throws IOException, CsvValidationException {
<span class="nc" id="L104">        inserimentoRivista(r);</span>
<span class="nc" id="L105">    }</span>

    @Override
    public void eliminaOggetto(File fd) throws CsvValidationException, IOException {
<span class="fc" id="L109">        cancellaById(fd);</span>
<span class="fc" id="L110">    }</span>

    @Override
    public void modificaLibro(File fd,Libro l) throws CsvValidationException, IOException, IdException {
<span class="nc" id="L114">        aggiornaLibro(fd,l);</span>
<span class="nc" id="L115">    }</span>

    @Override
    public void modificaRivista(File file, Rivista r) throws CsvValidationException, IOException, IdException {
<span class="nc" id="L119">        aggiornaRivista(file,r);</span>
<span class="nc" id="L120">    }</span>

    @Override
    public void modificaGiornale(File file, Giornale g) throws CsvValidationException, IOException, IdException {
<span class="nc" id="L124">        aggiornaGiornale(file,g);</span>
<span class="nc" id="L125">    }</span>



    private synchronized ObservableList&lt;Raccolta&gt; retrieveData(File fd) throws CsvValidationException, IOException, IdException {
<span class="fc" id="L130">        ObservableList&lt;Raccolta&gt; gList = FXCollections.observableArrayList();</span>
<span class="fc" id="L131">        CSVReader csvReader = new CSVReader(new BufferedReader(new FileReader(fd)));</span>
        String[] gVEctor;
<span class="pc bpc" id="L133" title="1 of 4 branches missed.">        switch (vis.getType())</span>
        {
            case LIBRO:

<span class="fc bfc" id="L137" title="All 2 branches covered.">                while ((gVEctor = csvReader.readNext()) != null) {</span>
<span class="fc" id="L138">                    String titolo = gVEctor[GETINDEXTITOLOL];</span>
<span class="fc" id="L139">                    String numeroPagine=gVEctor[GETINDEXNRPL];</span>
<span class="fc" id="L140">                    String isbn=gVEctor[GETINDEXISBNL];</span>
<span class="fc" id="L141">                    String editore=gVEctor[GETINDEXEDITOREL];</span>
<span class="fc" id="L142">                    String autore=gVEctor[GETINDEXAUTOREL];</span>
<span class="fc" id="L143">                    String lingua=gVEctor[GETINDEXLINGUAL];</span>
<span class="fc" id="L144">                    String categoria = gVEctor[GETINDEXCATEGORIAL];</span>
<span class="fc" id="L145">                    String data = gVEctor[GETINDEXDATAL];</span>
<span class="fc" id="L146">                    String recensione=gVEctor[GETINDEXRECENSIONEL];</span>
<span class="fc" id="L147">                    String copie = gVEctor[GETINDEXCOPIEL];</span>
<span class="fc" id="L148">                    String desc=gVEctor[GETINDEXDESCL];</span>
<span class="fc" id="L149">                    String disp = gVEctor[GETINDEXDISPL];</span>
<span class="fc" id="L150">                    String prezzo = gVEctor[GETINDEXPREZZOL];</span>
<span class="fc" id="L151">                    String id=gVEctor[GETINDEXIDL];</span>

<span class="fc" id="L153">                    Libro l=new Libro();</span>
<span class="fc" id="L154">                    l.setTitolo(titolo);</span>
<span class="fc" id="L155">                    l.setNrPagine(Integer.parseInt(numeroPagine));</span>
<span class="fc" id="L156">                    l.setCodIsbn(isbn);</span>
<span class="fc" id="L157">                    l.setEditore(editore);</span>
<span class="fc" id="L158">                    l.setAutore(autore);</span>
<span class="fc" id="L159">                    l.setLingua(lingua);</span>
<span class="fc" id="L160">                    l.setCategoria(categoria);</span>
<span class="fc" id="L161">                    l.setDataPubb(LocalDate.parse(data));</span>
<span class="fc" id="L162">                    l.setRecensione(recensione);</span>
<span class="fc" id="L163">                    l.setNrCopie(Integer.parseInt(copie));</span>
<span class="fc" id="L164">                    l.setDesc(desc);</span>
<span class="fc" id="L165">                    l.setDisponibilita(Integer.parseInt(disp));</span>
<span class="fc" id="L166">                    l.setPrezzo(Float.parseFloat(prezzo));</span>
<span class="fc" id="L167">                    l.setId(Integer.parseInt(id));</span>


<span class="fc" id="L170">                    gList.add(l);</span>

<span class="fc" id="L172">                }</span>
<span class="fc" id="L173">                csvReader.close();</span>
<span class="pc bpc" id="L174" title="1 of 2 branches missed.">                if (gList.isEmpty()) {</span>
<span class="nc" id="L175">                    throw new IdException(USERNOTFOUND);</span>
                }
                break;
            case GIORNALE:
<span class="fc bfc" id="L179" title="All 2 branches covered.">                while ((gVEctor = csvReader.readNext()) != null) {</span>


<span class="fc" id="L182">                    String titolo = gVEctor[GETINDEXTITOLOG];</span>
<span class="fc" id="L183">                    String tipologia = gVEctor[GETINDEXTIPOLOGIAG];</span>
<span class="fc" id="L184">                    String lingua = gVEctor[GETINDEXLINGUAG];</span>
<span class="fc" id="L185">                    String editore = gVEctor[GETINDEXEDITOREG];</span>
<span class="fc" id="L186">                    String data = gVEctor[GETINDEXDATAG];</span>
<span class="fc" id="L187">                    String copie = gVEctor[GETINDEXCOPIERG];</span>
<span class="fc" id="L188">                    String disp = gVEctor[GETINDEXDISPG];</span>
<span class="fc" id="L189">                    String prezzo = gVEctor[GETINDEXPREZZOG];</span>
<span class="fc" id="L190">                    String id=gVEctor[GETINDEXIDG];</span>
<span class="fc" id="L191">                    Giornale g = new Giornale();</span>
<span class="fc" id="L192">                    g.setTitolo(titolo);</span>
<span class="fc" id="L193">                    g.setTipologia(tipologia);</span>
<span class="fc" id="L194">                    g.setLingua(lingua);</span>
<span class="fc" id="L195">                    g.setEditore(editore);</span>
<span class="fc" id="L196">                    g.setDataPubb(LocalDate.parse(data));</span>
<span class="fc" id="L197">                    g.setCopieRimanenti(Integer.parseInt(copie));</span>
<span class="fc" id="L198">                    g.setDisponibilita(Integer.parseInt(disp));</span>
<span class="fc" id="L199">                    g.setPrezzo(Float.parseFloat(prezzo));</span>
<span class="fc" id="L200">                    g.setId(Integer.parseInt(id));</span>


<span class="fc" id="L203">                    gList.add(g);</span>

<span class="fc" id="L205">                }</span>
<span class="fc" id="L206">                csvReader.close();</span>
<span class="pc bpc" id="L207" title="1 of 2 branches missed.">                if (gList.isEmpty()) {</span>
<span class="nc" id="L208">                    throw new IdException(USERNOTFOUND);</span>
                }
                break;
            case RIVISTA:
<span class="fc bfc" id="L212" title="All 2 branches covered.">                while ((gVEctor = csvReader.readNext()) != null) {</span>


<span class="fc" id="L215">                    String titolo = gVEctor[GETINDEXTITOLOR];</span>
<span class="fc" id="L216">                    String tipologia = gVEctor[GETINDEXTIPOLOGIAR];</span>
<span class="fc" id="L217">                    String autore = gVEctor[GETINDEXAUTORER];</span>
<span class="fc" id="L218">                    String lingua = gVEctor[GETINDEXLINGUAR];</span>
<span class="fc" id="L219">                    String editore = gVEctor[GETINDEXEDITORER];</span>
<span class="fc" id="L220">                    String desc = gVEctor[GETINDEXDESCRIZIONER];</span>
<span class="fc" id="L221">                    String data = gVEctor[GETINDEXDATAR];</span>
<span class="fc" id="L222">                    String disp = gVEctor[GETINDEXDISPR];</span>
<span class="fc" id="L223">                    String prezzo = gVEctor[GETINDEXPREZZOR];</span>
<span class="fc" id="L224">                    String copie=gVEctor[GETINDEXCOPIER];</span>
<span class="fc" id="L225">                    String id=gVEctor[GETINDEXIDR];</span>

<span class="fc" id="L227">                    Rivista r=new Rivista();</span>
<span class="fc" id="L228">                    r.setTitolo(titolo);</span>
<span class="fc" id="L229">                    r.setTipologia(tipologia);</span>
<span class="fc" id="L230">                    r.setAutore(autore);</span>
<span class="fc" id="L231">                    r.setLingua(lingua);</span>
<span class="fc" id="L232">                    r.setEditore(editore);</span>
<span class="fc" id="L233">                    r.setDescrizione(desc);</span>
<span class="fc" id="L234">                    r.setDataPubb(LocalDate.parse(data));</span>
<span class="fc" id="L235">                    r.setDisp(Integer.parseInt(disp));</span>
<span class="fc" id="L236">                    r.setPrezzo(Float.parseFloat(prezzo));</span>
<span class="fc" id="L237">                    r.setCopieRim(Integer.parseInt(copie));</span>
<span class="fc" id="L238">                    r.setId(Integer.parseInt(id));</span>


<span class="fc" id="L241">                    gList.add(r);</span>

<span class="fc" id="L243">                }</span>
<span class="fc" id="L244">                csvReader.close();</span>
<span class="pc bpc" id="L245" title="1 of 2 branches missed.">                if (gList.isEmpty()) {</span>
<span class="nc" id="L246">                    throw new IdException(USERNOTFOUND);</span>
                }
                break;
            default:break;
        }

<span class="fc" id="L252">        return  gList;</span>
    }

    private static synchronized void inserimentoLibro(Libro l) throws IOException, CsvValidationException {


<span class="nc" id="L258">        CSVWriter csvWriter = new CSVWriter(new BufferedWriter(new FileWriter(LOCATIONL, true)));</span>
<span class="nc" id="L259">        String[] gVector = new String[14];</span>

<span class="nc" id="L261">        gVector[GETINDEXTITOLOL] = l.getTitolo();</span>
<span class="nc" id="L262">        gVector[GETINDEXNRPL] = String.valueOf(l.getNrPagine());</span>
<span class="nc" id="L263">        gVector[GETINDEXISBNL] = l.getCodIsbn();</span>
<span class="nc" id="L264">        gVector[GETINDEXEDITOREL] = l.getEditore();</span>
<span class="nc" id="L265">        gVector[GETINDEXAUTOREL] = l.getAutore();</span>
<span class="nc" id="L266">        gVector[GETINDEXLINGUAL] = l.getLingua();</span>
<span class="nc" id="L267">        gVector[GETINDEXCATEGORIAL] = l.getCategoria();</span>
<span class="nc" id="L268">        gVector[GETINDEXDATAL] = String.valueOf(l.getDataPubb());</span>
<span class="nc" id="L269">        gVector[GETINDEXRECENSIONEL] = l.getRecensione();</span>
<span class="nc" id="L270">        gVector[GETINDEXCOPIEL] = String.valueOf(l.getNrCopie());</span>
<span class="nc" id="L271">        gVector[GETINDEXDESCL] = l.getDesc();</span>
<span class="nc" id="L272">        gVector[GETINDEXDISPL] = String.valueOf(l.getDisponibilita());</span>
<span class="nc" id="L273">        gVector[GETINDEXPREZZOL] = String.valueOf(l.getPrezzo());</span>
<span class="nc" id="L274">        gVector[GETINDEXIDL] = String.valueOf(getIdMaxL() + 1);</span>
<span class="nc" id="L275">        csvWriter.writeNext(gVector);</span>
<span class="nc" id="L276">        csvWriter.flush();</span>
<span class="nc" id="L277">        csvWriter.close();</span>
<span class="nc" id="L278">    }</span>
    private static synchronized void inserimentoGiornale(Giornale g) throws IOException, CsvValidationException {

<span class="nc" id="L281">        CSVWriter csvWriter = new CSVWriter(new BufferedWriter(new FileWriter(LOCATIONG, true)));</span>
<span class="nc" id="L282">        String[] gVector = new String[9];</span>

<span class="nc" id="L284">        gVector[GETINDEXTITOLOG] = g.getTitolo();</span>
<span class="nc" id="L285">        gVector[GETINDEXTIPOLOGIAG] = g.getTipologia();</span>
<span class="nc" id="L286">        gVector[GETINDEXLINGUAG] = g.getLingua();</span>
<span class="nc" id="L287">        gVector[GETINDEXEDITOREG] = g.getEditore();</span>
<span class="nc" id="L288">        gVector[GETINDEXDATAG] = String.valueOf(g.getDataPubb());</span>
<span class="nc" id="L289">        gVector[GETINDEXCOPIERG] = String.valueOf(g.getCopieRimanenti());</span>
<span class="nc" id="L290">        gVector[GETINDEXDISPG] = String.valueOf(g.getDisponibilita());</span>
<span class="nc" id="L291">        gVector[GETINDEXPREZZOG] = String.valueOf(g.getPrezzo());</span>
<span class="nc" id="L292">        gVector[GETINDEXIDG] = String.valueOf(getIdMaxG()+1);</span>
<span class="nc" id="L293">        csvWriter.writeNext(gVector);</span>
<span class="nc" id="L294">        csvWriter.flush();</span>
<span class="nc" id="L295">        csvWriter.close();</span>
<span class="nc" id="L296">    }</span>
    private static synchronized void inserimentoRivista(Rivista r) throws IOException, CsvValidationException {

<span class="nc" id="L299">        CSVWriter csvWriter = new CSVWriter(new BufferedWriter(new FileWriter(LOCATIONR, true)));</span>
<span class="nc" id="L300">        String [] gVector = new String[11];</span>

<span class="nc" id="L302">        gVector[GETINDEXTITOLOR] = r.getTitolo();</span>
<span class="nc" id="L303">        gVector[GETINDEXTIPOLOGIAR] = r.getTipologia();</span>
<span class="nc" id="L304">        gVector[GETINDEXAUTORER] = r.getAutore();</span>
<span class="nc" id="L305">        gVector[GETINDEXLINGUAR] = r.getLingua();</span>
<span class="nc" id="L306">        gVector[GETINDEXEDITORER] =r.getEditore();</span>
<span class="nc" id="L307">        gVector[GETINDEXDESCRIZIONER] =r.getDescrizione();</span>
<span class="nc" id="L308">        gVector[GETINDEXDATAR] = String.valueOf(r.getDataPubb());</span>
<span class="nc" id="L309">        gVector[GETINDEXDISPR] = String.valueOf(r.getDisp());</span>
<span class="nc" id="L310">        gVector[GETINDEXPREZZOR] = String.valueOf(r.getPrezzo());</span>
<span class="nc" id="L311">        gVector[GETINDEXCOPIER]=String.valueOf(r.getCopieRim());</span>
<span class="nc" id="L312">        gVector[GETINDEXIDR]=String.valueOf(getIdMaxR()+1);</span>
<span class="nc" id="L313">        csvWriter.writeNext(gVector);</span>
<span class="nc" id="L314">        csvWriter.flush();</span>
<span class="nc" id="L315">        csvWriter.close();</span>
<span class="nc" id="L316">    }</span>
    private static synchronized int getIdMaxL() throws IOException, CsvValidationException {
        //used for insert correct idOgg
<span class="nc" id="L319">        CSVReader reader=new CSVReader(new FileReader(LOCATIONL));;</span>
        String[] gVector;
<span class="nc" id="L321">        int id = 0;</span>
<span class="nc bnc" id="L322" title="All 2 branches missed.">        while ((gVector = reader.readNext()) != null)</span>
<span class="nc" id="L323">            id = Integer.parseInt(gVector[GETINDEXIDL]);</span>

<span class="nc" id="L325">        return id;</span>

    }
    private static synchronized int getIdMaxG() throws IOException, CsvValidationException {
        //used for insert correct idOgg
<span class="nc" id="L330">        CSVReader reader=new CSVReader(new FileReader(LOCATIONG));</span>
        String[] gVector;
<span class="nc" id="L332">        int id = 0;</span>
<span class="nc bnc" id="L333" title="All 2 branches missed.">        while ((gVector = reader.readNext()) != null)</span>
<span class="nc" id="L334">            id = Integer.parseInt(gVector[GETINDEXIDG]);</span>

<span class="nc" id="L336">        return id;</span>

    }
    private static synchronized int getIdMaxR() throws IOException, CsvValidationException {
        //used for insert correct idOgg
<span class="nc" id="L341">        CSVReader reader=new CSVReader(new FileReader(LOCATIONR));;</span>
        String[] gVector;
<span class="nc" id="L343">        int id = 0;</span>
<span class="nc bnc" id="L344" title="All 2 branches missed.">        while ((gVector = reader.readNext()) != null)</span>
<span class="nc" id="L345">            id = Integer.parseInt(gVector[GETINDEXIDR]);</span>

<span class="nc" id="L347">        return id;</span>

    }
    private static synchronized void cancellaById(File fd) throws IOException, CsvValidationException {

<span class="pc bpc" id="L352" title="1 of 2 branches missed.">        if (SystemUtils.IS_OS_UNIX) {</span>
<span class="fc" id="L353">            FileAttribute&lt;Set&lt;PosixFilePermission&gt;&gt; attr = PosixFilePermissions.asFileAttribute(PosixFilePermissions.fromString(&quot;rwx------&quot;));</span>
<span class="fc" id="L354">            Files.createTempFile(&quot;prefix&quot;, &quot;suffix&quot;, attr); // Compliant</span>
        }
<span class="fc" id="L356">        File tmpFD = new File(&quot;report/appoggio.csv&quot;);</span>
<span class="fc" id="L357">        boolean found = false;</span>
        // create csvReader object passing file reader as a parameter
<span class="fc" id="L359">        CSVReader csvReader = new CSVReader(new BufferedReader(new FileReader(fd)));</span>
        String[] giornaleVector;
<span class="fc" id="L361">        CSVWriter csvWriter = new CSVWriter(new BufferedWriter(new FileWriter(tmpFD, true)));</span>
        //check on path
<span class="fc" id="L363">        boolean userVectorFound = false;</span>



<span class="fc bfc" id="L367" title="All 2 branches covered.">        while ((giornaleVector = csvReader.readNext()) != null) {</span>
<span class="pc bpc" id="L368" title="3 of 4 branches missed.">            switch (fd.getPath())</span>
            {
<span class="nc" id="L370">                case LOCATIONL -&gt;   userVectorFound = giornaleVector[GETINDEXIDL].equals(String.valueOf(vis.getId()));</span>
<span class="fc" id="L371">                case LOCATIONG -&gt;   userVectorFound = giornaleVector[GETINDEXIDG].equals(String.valueOf(vis.getId()));</span>
<span class="nc" id="L372">                case LOCATIONR -&gt;   userVectorFound = giornaleVector[GETINDEXIDR].equals(String.valueOf(vis.getId()));</span>
<span class="nc" id="L373">                default -&gt; java.util.logging.Logger.getLogger(&quot;test cancella by id&quot;).log(Level.SEVERE, &quot; file not exists \n&quot;);</span>

            }
<span class="pc bpc" id="L376" title="1 of 2 branches missed.">            if (!userVectorFound) {</span>
<span class="fc" id="L377">                    csvWriter.writeNext(giornaleVector);</span>
            } else {
<span class="nc" id="L379">                    found = userVectorFound;</span>
                }

            }

<span class="fc" id="L384">        csvWriter.flush();</span>
<span class="fc" id="L385">        csvReader.close();</span>
<span class="fc" id="L386">        csvWriter.close();</span>
<span class="pc bpc" id="L387" title="1 of 2 branches missed.">        if (found) {</span>
<span class="nc" id="L388">            Files.move(tmpFD.toPath(), fd.toPath(), REPLACE_EXISTING);</span>
        } else {
<span class="fc" id="L390">           cleanUp(Path.of(tmpFD.toURI()));</span>
        }

<span class="fc" id="L393">    }</span>
    private static synchronized void aggiornaLibro(File fd,Libro l) throws CsvValidationException, IOException, IdException {
<span class="nc" id="L395">        cancellaById(fd);</span>
<span class="nc" id="L396">        inserimentoLibro(l);</span>
<span class="nc" id="L397">    }</span>

    private static synchronized void aggiornaRivista(File file, Rivista r) throws CsvValidationException, IOException, IdException {

<span class="nc" id="L401">        cancellaById(file);</span>
<span class="nc" id="L402">        inserimentoRivista(r);</span>
<span class="nc" id="L403">    }</span>
    private static synchronized void aggiornaGiornale(File file, Giornale g) throws CsvValidationException, IOException, IdException {

<span class="nc" id="L406">        cancellaById(file);</span>
<span class="nc" id="L407">        inserimentoGiornale(g);</span>
<span class="nc" id="L408">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>